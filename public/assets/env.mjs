export const env=new class{constructor(){var t;this.handleNetworkChange=()=>{this.connection=window.navigator.connection.effectiveType,sessionStorage.removeItem("connection-choice")},this.memory=4,this.cpu=(null===(t=window.navigator)||void 0===t?void 0:t.hardwareConcurrency)||2,this.threadPool=this.cpu-2,this.connection="4g",this.domState="hard-loading",this.dataSaver=!1,this.browser="unknown",this.setBrowser(),this.tickets=[],this.init()}init(){"connection"in navigator&&(this.connection=window.navigator.connection.effectiveType,this.dataSaver=window.navigator.connection.saveData,navigator.connection.onchange=this.handleNetworkChange.bind(this)),"deviceMemory"in navigator&&(this.memory=window.navigator.deviceMemory)}stopLoading(t){if(t&&"string"==typeof t){for(let e=0;e<this.tickets.length;e++)if(this.tickets[e]===t){this.tickets.splice(e,1);break}0===this.tickets.length&&"soft-loading"===this.domState&&(this.domState="idling",document.documentElement.setAttribute("state",this.domState))}}startLoading(){"hard-loading"!==this.domState&&(this.domState="soft-loading",document.documentElement.setAttribute("state",this.domState));const t=this.uid();return this.tickets.push(t),t}startPageTransition(){this.domState="page-loading",document.documentElement.setAttribute("state",this.domState)}endPageTransition(){this.domState="page-loading-complete",document.documentElement.setAttribute("state",this.domState),setTimeout(()=>{this.tickets.length?(this.domState="soft-loading",document.documentElement.setAttribute("state",this.domState)):(this.domState="idling",document.documentElement.setAttribute("state",this.domState))},600)}uid(){return new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}setDOMState(t){this.domState=t,document.documentElement.setAttribute("state",this.domState)}checkConnection(t){let e=!1;switch(t){case"4g":"2g"!==this.connection&&"slow-2g"!==this.connection&&"3g"!==this.connection&&(e=!0);break;case"3g":"2g"!==this.connection&&"slow-2g"!==this.connection&&(e=!0);break;case"2g":"slow-2g"!==this.connection&&(e=!0);break;case"slow-2g":default:e=!0}return e}setBrowser(){const t=!!window.opr&&!!opr.addons||!!window.opera||navigator.userAgent.indexOf(" OPR/")>=0,e="undefined"!=typeof InstallTrigger,o=/constructor/i.test(window.HTMLElement)||"[object SafariRemoteNotification]"===(!window.safari||"undefined"!=typeof safari&&safari.pushNotification).toString(),n=!!document.documentMode,i=!n&&!!window.StyleMedia,s=!!window.chrome,a=s&&-1!=navigator.userAgent.indexOf("Edg");this.browser=t?"opera":e?"firefox":o?"safari":n?"ie":i?"edge":s?"chrome":a?"chromium-edge":"unknown",document.documentElement.classList.add(this.browser)}reserveThread(){return new Promise((t,e)=>{this.threadPool-1<0?e("Thread pool is empty"):(this.threadPool--,t())})}releaseThread(){this.threadPool++}};export const uid=env.uid;export const dataSaver=env.dataSaver;export const browser=env.browser;export const checkConnection=env.checkConnection.bind(env);export const reserveThread=env.reserveThread.bind(env);export const releaseThread=env.releaseThread.bind(env);